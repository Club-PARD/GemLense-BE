<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wecand API Test</title>
    <script>
        // 공통 API 호출 함수
        async function callAPI(url, method = 'GET', body = null) {
            try {
                const headers = { 'Content-Type': 'application/json' };
                const options = {
                    method: method,
                    headers: headers,
                    credentials: 'include', // 세션 쿠키 포함
                };
                if (body) options.body = JSON.stringify(body);

                const response = await fetch(url, options);
                if (!response.ok) {
                    throw new Error(`API 요청 실패: ${response.status}`);
                }
                return await response.json();
            } catch (error) {
                console.error(error.message);
                alert('API 요청 중 오류가 발생했습니다!');
            }
        }

        // 유저 정보 가져오기
        async function getUserInfo() {
            const userId = document.getElementById('userId').value;
            const data = await callAPI(`/user/${userId}`);
            if (data) {
                document.getElementById('output').innerText = JSON.stringify(data, null, 2);
            }
        }

        // 유저의 Land 정보 가져오기
        async function getUserLands() {
            const userId = document.getElementById('userId').value;
            const data = await callAPI(`/user/${userId}/lands`);
            if (data) {
                document.getElementById('output').innerText = JSON.stringify(data, null, 2);
            }
        }

        // Post 생성
        async function createPost() {
            const postData = {
                title: document.getElementById('postTitle').value,
                category: document.getElementById('postCategory').value,
                member: document.getElementById('postMember').value,
            };
            const data = await callAPI('/post', 'POST', postData);
            if (data) {
                document.getElementById('output').innerText = JSON.stringify(data, null, 2);
            }
        }

        // Land 생성
        async function createLand() {
            const postId = document.getElementById('postIdForLand').value;
            const body = {};
            const data = await callAPI(`/land/${postId}/create`, 'POST', body);
            if (data) {
                document.getElementById('output').innerText = JSON.stringify(data, null, 2);
            }
        }

        // Land 멤버 정보 가져오기
        async function getLandMembers() {
            const landId = document.getElementById('landId').value;
            const data = await callAPI(`/land/${landId}/members`);
            if (data) {
                document.getElementById('output').innerText = JSON.stringify(data, null, 2);
            }
        }
    </script>
</head>
<body>
<h1>Wecand API Test Interface</h1>

<h2>유저 정보</h2>
<input type="text" id="userId" placeholder="유저 ID 입력" />
<button onclick="getUserInfo()">유저 정보 가져오기</button>
<button onclick="getUserLands()">유저의 Land 정보 가져오기</button>

<h2>Post 생성</h2>
<input type="text" id="postTitle" placeholder="Post 제목" />
<input type="text" id="postCategory" placeholder="Post 카테고리" />
<input type="text" id="postMember" placeholder="Post 멤버 수" />
<button onclick="createPost()">Post 생성</button>

<h2>Land 생성</h2>
<input type="text" id="postIdForLand" placeholder="Post ID" />
<button onclick="createLand()">Land 생성</button>

<h2>Land 멤버</h2>
<input type="text" id="landId" placeholder="Land ID" />
<button onclick="getLandMembers()">Land 멤버 정보 가져오기</button>

<h3>API 응답</h3>
<pre id="output" style="background-color: #f4f4f4; padding: 10px; border: 1px solid #ccc; overflow-x: auto;"></pre>
</body>
</html>
